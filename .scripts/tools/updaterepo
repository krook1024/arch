#!/bin/env bash

REPODIR="$HOME/Repos/arch"

copyfiles() {
	cd ~

	files=(\
	# Bash related
	.bashrc .bash_profile .zprofile .profile .inputrc \
	# Tmux
	.tmux.conf \
	# Vim related
	.vimrc .config/nvim/init.vim .config/nvim/autoload/plug.vim \
	# X related
	.xinitrc .Xresources \
	# Shortcut files
	.config/bmdirs .config/bmfiles \
	# Compton config
	.config/compton.conf  \
	# Wallpaper
	.config/wall.png  \
	# Git configuration
	.gitconfig \
	# Default applications
	.config/mimeapps.list )

	for file in "${files[@]}"; do
		cp -P --parents $file $REPODIR
	done
}

copydirs() {
	cd ~

	directories=(.scripts \
	.config/dunst \
	.config/i3 \
	.config/i3blocks \
	.config/zathura \
	.config/ranger \
	.vim \
	.config/gtk-2.0
	.config/gtk-3.0)

	for dir in "${directories[@]}"; do
		cp -P -r --parents $dir $REPODIR
	done
}

gitupdate() {
	cd $REPODIR
	git add .
	git commit -m "Update to dotfiles on $(date)"
	git push
}

updaterepo() {
	copyfiles || echo "Failed to copy files."
	copydirs || echo "Failed to copy directories."
	gitupdate || echo "Failed to upload changes to git."
}

updaterepo || echo "Faliora."
